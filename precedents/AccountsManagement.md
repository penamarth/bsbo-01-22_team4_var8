# Прецедент: "Управление учетной записью и данными"

---

**Информационная система жилищного агентства.**

**Уровень**: Задача, определенная пользователем.

**Основной исполнитель**: Пользователь (владелец или квартиросъёмщик).

## Заинтересованные лица и их требования:

- **Пользователь (владелец или квартиросъёмщик)**: Хочет легко управлять своими личными данными, изменять контактную информацию, настройки профиля и платежные данные, а также иметь возможность удалять свою учетную запись при необходимости.
- **Администратор системы**: Хочет убедиться, что данные пользователей хранятся и обрабатываются корректно, соответствуя требованиям безопасности и законодательства о защите персональных данных.
- **Компания (владелец платформы)**: Хочет гарантировать безопасность данных пользователей и избежать утечек или некорректного использования информации, а также обеспечить доступность и удобство управления учетными записями.

## Предусловия:

- Пользователь зарегистрирован и аутентифицирован в системе.
- У пользователя есть доступ к интерфейсу управления учетной записью через личный кабинет.

## Результаты (Постусловия):

- Пользователь успешно изменил данные учетной записи (например, контактную информацию или платежные реквизиты).
- Пользователь может безопасно удалить свою учетную запись, при этом система корректно обработала удаление и прекратила обработку данных.
- Система сохранила все изменения и обновила соответствующие данные в базе.
- Система отправила уведомления о ключевых изменениях пользователю и/или администратору.

## Основной успешный сценарий:

1. **Доступ к настройкам учетной записи**:
    - Пользователь заходит в личный кабинет и выбирает опцию "Управление учетной записью".
    - Система загружает текущие данные пользователя, вызывая метод `UserAccount::loadData()`.

2. **Редактирование личных данных**:
    - Пользователь изменяет необходимые поля (например, телефон, email, адрес и т.д.).
    - Система проверяет корректность введённых данных через метод `UserAccount::validateData()`.
    - После успешной проверки система вызывает метод `UserAccount::saveChanges()` для сохранения данных в базе.

3. **Изменение платежной информации**:
    - Пользователь переходит в раздел "Платёжные данные".
    - Система предлагает изменить или удалить текущие платежные реквизиты, используя метод `Payment::updateDetails()`.
    - После успешного изменения система уведомляет пользователя о том, что данные обновлены.

4. **Удаление учетной записи**:
    - Пользователь выбирает опцию "Удалить учетную запись".
    - Система предупреждает о последствиях и предлагает подтвердить действие через метод `UserAccount::confirmDeletion()`.
    - После подтверждения система удаляет данные учетной записи и деактивирует пользователя, вызывая метод `UserAccount::delete()`.

5. **Уведомление о действиях**:
    - После каждого ключевого изменения (изменение данных, платежных реквизитов, удаление учетной записи) система уведомляет пользователя через метод `notifyUser(user_id, message)` и/или администратора о выполненных изменениях.

## Варианты альтернативных решений:

* **2.1 Пользователь указывает некорректные данные**:
    1. Система получает некорректные или неполные данные (например, неверный формат email).
    2. Система вызывает метод `UserAccount::showErrors()` и уведомляет пользователя о необходимости исправить ошибки.

* **3.1 Пользователь запрашивает удаление платежных данных без замены**:
    1. Пользователь пытается удалить платежные реквизиты, не добавляя новые.
    2. Система уведомляет, что для продолжения использования услуг необходимо указать новые данные, вызывая метод `Payment::requireUpdate()`.

* **4.1 Пользователь хочет восстановить учетную запись**:
    1. Пользователь пытается повторно войти в систему после удаления учетной записи.
    2. Система показывает сообщение, что учетная запись была удалена и восстановлению не подлежит, вызывая метод `UserAccount::showDeletedMessage()`.

* **5.1 Ошибка при сохранении данных**:
    1. Система сталкивается с технической проблемой при сохранении изменений.
    2. Пользователь получает уведомление о временной ошибке и рекомендации попробовать снова через `UserAccount::notifyError()`.

## Расширения (или альтернативные потоки)

*а. Периодическая проверка активности учетной записи:

1. Система периодически проверяет активность пользователей.
2. Администратор получает уведомления о длительной неактивности учетных записей через метод `Admin::checkInactivity()`.
3. Система предлагает пользователю вернуться или удалить неиспользуемые учетные записи, вызывая `UserAccount::remindInactivity()`.

*б. Восстановление доступа к учетной записи после сбоя:

1. Пользователь сообщает о сбое при входе в учетную запись.
2. Администратор перезапускает систему, используя метод `System::restart()` и возвращает пользователя к последнему действию через `UserAccount::restoreSession()`.

## Специальные требования:

- Все изменения в учетной записи должны быть логированы и доступны для администратора.
- Система должна поддерживать многофакторную аутентификацию для повышения безопасности данных.
- Обработка удаления учетной записи должна быть необратимой и полностью соответствовать требованиям защиты данных (GDPR).
- Время обработки изменений не должно превышать 2 минут.
- Платёжная система должна обеспечивать безопасность и защиту данных в соответствии с внутренними стандартами компании.

## Список технологий и типов данных:

- Данные защищены с использованием шифрования (SSL/TLS).
- Платёжные данные обрабатываются и хранятся в соответствии с внутренними политиками безопасности компании.

## Частота использования:

- Ожидается высокая частота использования при регистрации новых пользователей и изменении личных данных, особенно во время периодов активного использования системы.

## Открытые вопросы:

- Нужно ли автоматически деактивировать учетные записи, которые не используются определённый период?
- Какие дополнительные меры безопасности могут быть необходимы для защиты платёжных данных пользователей?
- Нужно ли предоставлять возможность временной деактивации учетной записи вместо её полного удаления?
