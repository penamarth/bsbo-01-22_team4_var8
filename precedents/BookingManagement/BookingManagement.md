
# Описание прецедента: "Управление бронированием"

**Информационная система жилищного агентства.**

**Уровень:** Задача, определенная пользователем.

## Основные исполнители:
- Квартиросъёмщик (Tenant)
- Владелец (Owner)

---

## Заинтересованные лица и их требования:
- **Квартиросъёмщик:**
  - Управлять своими бронированиями (создавать, отменять).

- **Владелец:**
  - Подтверждать или отменять бронирования.

---

## Предусловия:
- Квартиросъёмщик и владелец зарегистрированы и аутентифицированы в системе.
- Данные о недвижимости и доступности актуальны.

---

## Результаты (Постусловия):
1. Бронирование успешно создано, подтверждено или отменено.
2. Уведомления о состоянии бронирования отправлены квартиросъёмщику и владельцу.

---

## Основной успешный сценарий:

1. **Создание бронирования:**
    - Квартиросъёмщик инициирует создание бронирования через интерфейс.
    - Система через `BookingSystemFacade` вызывает метод `UserManager.getUser(tenantID)` для проверки данных пользователя.
    - Затем `BookingSystemFacade` вызывает метод `BookingManager.createBooking(tenantID, propertyID, dates)`.
    - Внутри `BookingManager` вызывается метод `Booking.formRentalAgreement(tenantID, propertyID, dates)` для формирования договора аренды.
    - После успешного сохранения, `BookingManager` возвращает идентификатор бронирования в `BookingSystemFacade`.
    - Система уведомляет участников через `Notification.notifyObservers(bookingCreatedNotification)`.
    - Квартиросъёмщик получает подтверждение о создании бронирования.

2. **Подтверждение бронирования владельцем:**
    - Владелец получает уведомление о новом бронировании.
    - Через интерфейс владелец инициирует подтверждение бронирования.
    - Система через `BookingSystemFacade` вызывает метод `BookingManager.updateBooking(bookingID, updatedBooking)`.
    - Система обновляет статус бронирования на "Confirmed".
    - Уведомления о подтверждении бронирования отправляются через `Notification.notifyObservers(bookingConfirmedNotification)`.
    - Квартиросъёмщик получает уведомление о подтверждении бронирования.

3. **Отмена бронирования:**
    - Квартиросъёмщик инициирует отмену бронирования через интерфейс.
    - Система через `BookingSystemFacade` вызывает метод `BookingManager.cancelBooking(bookingID)`.
    - Статус бронирования обновляется на "Cancelled".
    - Уведомления о статусе отмены отправляются через `Notification.notifyObservers(bookingCancelledNotification)`.
    - Квартиросъёмщик и владелец получают уведомления об отмене.

---

## Варианты альтернативных решений:

1. **Некорректное бронирование:**
    - Если создание бронирования невозможно (например, объект уже забронирован), система уведомляет квартиросъёмщика.

2. **Отмена владельцем:**
    - Если владелец отменяет бронирование, вызывается метод `BookingManager.updateBooking(bookingID, "Cancelled")`.
    - Уведомления отправляются участникам.

---

## Специальные требования:
- Все действия должны фиксироваться с минимальной задержкой.
- Уведомления должны быть отправлены на e-mail и отображены в личном кабинете.
